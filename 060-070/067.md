# 第67课：从递归入手二维动态规划

### 一、二维动态规划概述

- **与递归的关系**：从递归入手是理解和实现二维动态规划的重要途径。如果一个递归问题的尝试函数有2个可变参数能完全决定返回值，那么就可以改写成二维动态规划的实现。
- **实现过程**：
  - **写出尝试递归**：这是基础步骤，需要明确递归的逻辑和边界条件。
  - **记忆化搜索**：这是一种自顶向下的动态规划方式，通过存储已经计算过的子问题结果，避免重复计算。
  - **严格位置依赖的动态规划**：这是自底向上的动态规划方式，从简单的格子（子问题）开始填写动态规划表，逐步解决更复杂的格子，直到求解出最终问题。

### 二、动态规划表相关知识

- **大小确定**：动态规划表的大小等于每个可变参数的可能性数量相乘。例如，对于二维动态规划，如果有两个可变参数，分别有m和n种可能性，那么动态规划表的大小就是m×n。
- **时间复杂度**：动态规划方法的时间复杂度等于动态规划表的大小乘以每个格子的枚举代价。枚举代价是指在填写每个格子时，需要进行的操作数量。
- **依赖关系整理**：二维动态规划需要整理动态规划表的格子之间的依赖关系。可以通过画图来建立空间感，使依赖关系更明显。然后按照从简单格子到复杂格子的顺序填写动态规划表。

### 三、空间压缩技巧

- **原理**：二维动态规划的空间压缩技巧原理并不难，一旦掌握，不同题目虽然依赖关系不一样，但都可以通过细心画图整理具体题目的依赖关系，进而实现空间压缩。
- **重要性**：掌握空间压缩技巧可以有效减少动态规划所需的存储空间，提高算法的效率和实用性。

### 四、适合改写成动态规划的递归特征

- **可变参数类型简单**：能改成动态规划的递归，其决定返回值的可变参数类型往往都比较简单，一般不会比int类型更复杂。这是因为复杂的可变参数类型（如带路径的递归）难以用简单的表格形式存储和管理，所以不适合或没必要改成动态规划。
- **可变参数的全面性**：要保证这些可变参数可以完全代表之前决策过程对后续过程的影响，这样才能确保动态规划的有效性。无论几维动态规划，都应从递归的定义出发，避免后续进行很多边界讨论，这需要一定的经验来预知。

### 五、典型题目分析

- **题目1：最小路径和**
  - **问题描述**：给定一个包含非负整数的 m x n 网格 grid，找出一条从左上角到右下角的路径，使得路径上的数字总和为最小。每次只能向下或者向右移动一步。
  - **解题思路**：这是一个典型的二维动态规划问题。可以定义一个二维动态规划表dp，其中dp[i][j]表示从左上角到位置(i, j)的最小路径和。状态转移方程为dp[i][j] = grid[i][j] + min(dp[i - 1][j], dp[i][j - 1])，表示到达位置(i, j)的最小路径和等于当前位置的值加上从上方或左方来的最小路径和。初始状态为dp[0][0] = grid[0][0]，边界条件为第一行和第一列只能从一个方向来。
- **题目2：单词搜索（无法改成动态规划）**
  - **问题描述**：给定一个 m x n 二维字符网格 board 和一个字符串单词 word，判断 word 是否存在于网格中。单词必须按照字母顺序，通过相邻的单元格内的字母构成，且同一个单元格内的字母不允许被重复使用。
  - **解题思路**：这是一个回溯算法问题，不适合改成动态规划。因为其递归的可变参数类型复杂，涉及到路径的记录和回溯过程，难以用简单的动态规划表来存储和管理。
- **题目3：最长公共子序列**
  - **问题描述**：给定两个字符串text1和text2，返回这两个字符串的最长公共子序列的长度。如果不存在公共子序列，返回0。
  - **解题思路**：这是一个经典的二维动态规划问题。可以定义一个二维动态规划表dp，其中dp[i][j]表示text1的前i个字符和text2的前j个字符的最长公共子序列的长度。状态转移方程为：如果text1[i - 1] == text2[j - 1]，则dp[i][j] = dp[i - 1][j - 1] + 1；否则，dp[i][j] = max(dp[i - 1][j], dp[i][j - 1])。初始状态为dp[0][j] = 0和dp[i][0] = 0。
- **题目4：最长回文子序列**
  - **问题描述**：给定一个字符串 s，找出其中最长的回文子序列，并返回该序列的长度。
  - **解题思路**：这是一个二维动态规划问题。可以定义一个二维动态规划表dp，其中dp[i][j]表示字符串s从第i个字符到第j个字符的最长回文子序列的长度。状态转移方程为：如果s[i] == s[j]，则dp[i][j] = dp[i + 1][j - 1] + 2；否则，dp[i][j] = max(dp[i + 1][j], dp[i][j - 1])。初始状态为dp[i][i] = 1。
- **题目5：节点数为n高度不大于m的二叉树个数**
  - **问题描述**：现在有n个节点，计算出有多少个不同结构的二叉树，满足节点个数为n且树的高度不超过m的方案。因为答案很大，所以答案需要模上1000000007后输出。
  - **解题思路**：这是一个二维动态规划问题。可以定义一个二维动态规划表dp，其中dp[i][j]表示节点数为i且高度不大于j的二叉树个数。状态转移方程需要根据二叉树的性质和高度限制来推导。
- **题目6：矩阵中的最长递增路径**
  - **问题描述**：给定一个 m x n 整数矩阵 matrix，找出其中最长递增路径的长度。对于每个单元格，可以往上、下、左、右四个方向移动，不能在对角线方向上移动或移动到边界外。
  - **解题思路**：这是一个二维动态规划问题。可以定义一个二维动态规划表dp，其中dp[i][j]表示从位置(i, j)开始的最长递增路径的长度。状态转移方程需要根据矩阵中相邻单元格的值来确定递增关系，并通过记忆化搜索或严格位置依赖的动态规划来求解。