# 第56课：并查集（上）

### 并查集的原理和应用

#### 1. **并查集的基本概念**

并查集（Union-Find）是一种数据结构，用于处理元素的动态集合合并和查询问题。它支持以下三种主要操作：

1. **`find(i)`**：查找元素 i 所在集合的代表元素（根节点）。
2. **`union(a, b)`**：将元素 a 和 b 所在的两个集合合并为一个集合。
3. **`isSameSet(a, b)`**：判断元素 a 和 b 是否属于同一个集合。

#### 2. **并查集的实现原理**

并查集的实现基于两种主要的优化方法：

1. **路径压缩（Path Compression）**
   - 在查找过程中，将路径上的所有节点直接连接到根节点，从而缩短后续查找的路径长度。
   - 这使得后续的查找操作的时间复杂度接近 O(1)。
2. **按秩合并（Union by Rank）**
   - 在合并两个集合时，将较小的树合并到较大的树上，避免树的深度过大。
   - 这里的“秩”可以理解为树的粗略高度或大小。

#### 3. **并查集的时间复杂度**

并查集的时间复杂度在单次调用时几乎是 O(1)，具体为阿克曼函数的反函数 α(n)。阿克曼函数的反函数增长非常缓慢，对于实际应用中的 n（如 1080），α(n) 的值不超过 6，因此可以将其视为常数时间复杂度。

#### 4. **并查集的应用场景**

并查集适用于以下类型的问题：

1. **动态连通性问题**
   - 判断图中两个节点是否连通。
   - 例如，社交网络中好友关系的连通性问题。
2. **集合合并问题**
   - 将多个动态集合合并，并支持快速查询。
3. **最小生成树（Kruskal 算法）**
   - 在 Kruskal 算法中，使用并查集来判断边是否形成环路。
4. **连通分量问题**
   - 统计图中连通分量的数量。
5. **优化问题**
   - 在需要频繁进行集合合并和查询的场景中，使用并查集可以显著提高效率。

#### 5. **并查集的具体应用实例**

##### **问题 1：情侣牵手**

题目链接：https://leetcode.cn/problems/couples-holding-hands/

**问题描述**：有 n 对情侣坐在 2n 个座位上，每个人有一个唯一的 ID。通过交换座位，使得每对情侣并排坐在一起。求最少需要交换多少次。

**解题思路**：

- 将座位视为顶点，将情侣对视为边。
- 使用并查集统计连通分量的数量。
- 每个连通分量需要的交换次数为 size−1，总交换次数为所有连通分量的交换次数之和。

##### **问题 2：相似字符串组**

题目链接：https://leetcode.cn/problems/similar-string-groups/

**问题描述**：给定一组字符串，如果两个字符串可以通过交换两个字符变成相同的字符串，则它们是相似的。统计所有相似字符串组的数量。

**解题思路**：

- 使用并查集将相似的字符串合并到同一集合。
- 统计最终的连通分量数量即为相似字符串组的数量。

##### **问题 3：岛屿数量**

题目链接：https://leetcode.cn/problems/number-of-islands/

**问题描述**：给定一个二维网格，由 '1'（陆地）和 '0'（水）组成，计算岛屿的数量。

**解题思路**：

- 将每个陆地单元格视为一个节点。
- 使用并查集将相邻的陆地单元格合并。
- 统计最终的连通分量数量即为岛屿的数量。

#### 6. **并查集的优势**

并查集的优势在于其高效性和简单性：

- **高效性**：单次操作的时间复杂度接近 O(1)，适用于大规模数据。
- **灵活性**：可以动态处理集合的合并和查询。
- **易实现**：代码实现简单，适合快速解决实际问题。

通过以上分析，可以看出并查集是一种非常强大且实用的数据结构，广泛应用于各类算法和实际问题中。